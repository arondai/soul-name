<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoulName: Your K-Name Destiny</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="ìƒë…„ì›”ì¼ì‹œë¥¼ ì…ë ¥í•˜ê³  ì‚¬ì£¼ì— ë§ëŠ” ìµœê³ ì˜ í•œêµ­ ì´ë¦„ì„ ì¶”ì²œë°›ìœ¼ì„¸ìš”. ì˜¤í–‰ ë¶„ì„ì„ í†µí•´ ë‹¹ì‹ ì˜ ìš´ëª…ì„ ì¡°í™”ë¡­ê²Œ ë§Œë“¤ ì´ë¦„ì„ ì°¾ì•„ë“œë¦½ë‹ˆë‹¤.">
    <meta name="keywords" content="ì‘ëª…, ì´ë¦„ì§“ê¸°, ì‚¬ì£¼, ì‚¬ì£¼í’€ì´, í•œêµ­ ì´ë¦„, ì•„ê¸° ì´ë¦„, ê°œëª…, K-Name, Saju">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Nanum+Gothic:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Nanum Gothic', sans-serif;
        }
        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3b82f6;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .section-hidden {
            display: none;
            opacity: 0;
            transition: opacity 0.7s ease-in-out;
        }
        .section-visible {
            display: block;
            opacity: 1;
        }
        .hanja {
            font-size: 1.1em;
            font-weight: 600;
            color: #1e3a8a;
        }
        .dropdown-options {
            transition: opacity 0.2s ease-out, transform 0.2s ease-out;
        }
        @keyframes pulse-glow {
            0%, 100% {
                transform: scale(1);
                text-shadow: 0 0 5px rgba(59, 130, 246, 0.2);
            }
            50% {
                transform: scale(1.03);
                text-shadow: 0 0 15px rgba(59, 130, 246, 0.6);
            }
        }
        .pulsing-link {
            display: inline-block;
            animation: pulse-glow 2.5s infinite ease-in-out;
        }
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 24px;
            border: 1px solid #888;
            width: 90%;
            max-width: 500px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-4xl">
        
        <header class="flex justify-between items-center mb-8">
            <h1 class="text-2xl md:text-3xl font-bold text-gray-900" data-lang="pageTitle">SoulName: Your K-Name Destiny</h1>
            <div class="relative" id="languageSelectorContainer">
                <button type="button" id="languageSelectorButton" class="inline-flex items-center justify-center w-full rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    <span id="selectedLangFlag" class="mr-2">ğŸ‡ºğŸ‡¸</span>
                    <span id="selectedLangText">EN</span>
                </button>
                <div id="languageOptions" class="hidden dropdown-options origin-top-right absolute right-0 mt-2 w-32 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-10">
                    <div class="py-1" role="none">
                        <a href="#" class="lang-option text-gray-700 flex items-center px-4 py-2 text-sm hover:bg-gray-100" data-lang="en"><span class="mr-2">ğŸ‡ºğŸ‡¸</span><span>EN</span></a>
                        <a href="#" class="lang-option text-gray-700 flex items-center px-4 py-2 text-sm hover:bg-gray-100" data-lang="es"><span class="mr-2">ğŸ‡ªğŸ‡¸</span><span>ES</span></a>
                        <a href="#" class="lang-option text-gray-700 flex items-center px-4 py-2 text-sm hover:bg-gray-100" data-lang="ko"><span class="mr-2">ğŸ‡°ğŸ‡·</span><span>KR</span></a>
                    </div>
                </div>
            </div>
        </header>

        <main>
            <section id="introSection" class="bg-white p-6 md:p-8 rounded-xl shadow-lg mb-8">
                <p class="text-lg text-center mb-6" data-lang="introText">Discover your personalized Korean name, crafted from the cosmic blueprint of your birth date and time.</p>
                <form id="sajuForm" novalidate>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <div>
                            <label for="year" class="block text-sm font-medium text-gray-700" data-lang="yearLabel">Year</label>
                            <input type="number" id="year" placeholder="YYYY" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                            <p id="yearError" class="text-red-600 text-sm mt-1 h-5"></p>
                        </div>
                        <div>
                            <label for="month" class="block text-sm font-medium text-gray-700" data-lang="monthLabel">Month</label>
                            <select id="month" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"></select>
                            <p class="h-5"></p>
                        </div>
                        <div>
                            <label for="day" class="block text-sm font-medium text-gray-700" data-lang="dayLabel">Day</label>
                            <input type="number" id="day" placeholder="DD" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                             <p id="dayError" class="text-red-600 text-sm mt-1 h-5"></p>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div><label for="hour" class="block text-sm font-medium text-gray-700" data-lang="hourLabel">Hour</label><select id="hour" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"></select></div>
                        <div><label for="minute" class="block text-sm font-medium text-gray-700" data-lang="minuteLabel">Minute</label><select id="minute" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"></select></div>
                        <div><label class="block text-sm font-medium text-gray-700" data-lang="genderLabel">Gender</label><div class="mt-2 flex items-center space-x-4"><label class="inline-flex items-center"><input type="radio" name="gender" value="male" class="form-radio text-blue-600" checked><span class="ml-2" data-lang="male">Male</span></label><label class="inline-flex items-center"><input type="radio" name="gender" value="female" class="form-radio text-pink-600"><span class="ml-2" data-lang="female">Female</span></label></div></div>
                    </div>
                    <button type="submit" id="submitButton" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:scale-105"><span data-lang="findNameButton">Find My K-Name</span></button>
                </form>
            </section>

            <div id="loader" class="hidden justify-center items-center my-8"><div class="loader"></div></div>

            <section id="resultsSection" class="section-hidden">
                <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                    <h2 class="text-2xl md:text-3xl font-bold text-center mb-2" data-lang="resultTitle">Your Saju Profile & Name Recommendations</h2>
                    <p class="text-center text-gray-500 mb-8"><span data-lang="generatedFor">Generated for birth date</span>: <span id="birthDateDisplay" class="font-semibold"></span></p>
                    <div class="mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200"><h3 class="text-xl font-bold mb-4 text-gray-800" data-lang="sajuReadingTitle">1. Your Saju Analysis</h3><div id="sajuAnalysisReport" class="text-gray-700 leading-relaxed space-y-3"></div></div>
                    <div class="mb-8"><h3 class="text-xl font-bold mb-4 text-gray-800" data-lang="fiveElementsDistributionTitle">2. Five Elements Distribution</h3><div id="fiveElementsChart" class="grid grid-cols-5 gap-2 md:gap-4 items-end min-h-[160px] bg-gray-50 p-4 rounded-lg border border-gray-200"></div></div>
                    <div class="mb-8"><h3 class="text-xl font-bold mb-4 text-gray-800" data-lang="recommendedNamesTitle">3. Recommended Names to Harmonize Your Energy</h3><div id="recommendedNames" class="space-y-6"></div></div>
                    <div id="detailLinkContainer" class="mt-10 pt-6 border-t border-gray-200 text-center">
                        <a href="https://t.me/your_saju_expert" target="_blank" class="text-blue-600 hover:text-blue-800 underline font-semibold pulsing-link" data-lang="detailLink">For a more detailed Saju reading, please click here!</a>
                    </div>
                    <p id="timeInfo" class="mt-6 text-sm text-center text-gray-500" data-lang="timeInfo"></p>
                </div>
            </section>
        </main>
        
        <footer class="text-center text-gray-500 text-sm mt-12 space-y-2">
            <div class="space-x-4">
                <a href="#" id="privacyPolicyLink" class="hover:underline" data-lang="privacyPolicy">Privacy Policy</a>
                <span>|</span>
                <a href="#" id="termsOfServiceLink" class="hover:underline" data-lang="termsOfService">Terms of Service</a>
            </div>
            <p data-lang="entertainmentOnly">For entertainment purposes only. SoulName: Your K-Name Destiny &copy; 2024.</p>
        </footer>
    </div>

    <!-- Modals for Legal Information -->
    <div id="privacyModal" class="modal"><div class="modal-content"><h2 class="text-xl font-bold mb-4" data-lang="privacyPolicy">Privacy Policy</h2><p class="mb-4" data-lang="privacyText">We do not collect, store, or share any personal information you enter. All data, including your birth date and time, is processed only within your browser and is never sent to our servers. Your privacy is fully protected.</p><button id="closePrivacyModal" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700" data-lang="close">Close</button></div></div>
    <div id="termsModal" class="modal"><div class="modal-content"><h2 class="text-xl font-bold mb-4" data-lang="termsOfService">Terms of Service</h2><p class="mb-4" data-lang="termsText">This service is provided for entertainment purposes only. The analyses and name recommendations are based on simplified principles of Saju Myeongrihak and should not be taken as professional advice. By using this service, you agree that the developers are not liable for any decisions made based on the information provided.</p><button id="closeTermsModal" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700" data-lang="close">Close</button></div></div>

<script>
// ===================================================================================
// I. SAJU NAMER ENGINE - KNOWLEDGE BASE
// ===================================================================================
const HanjaInfo = [
    // --- Water Element (æ°´) --- 30
    { hanja: 'æ²³', hangul: 'í•˜', jawon: 'water', meaning: { en: 'river', ko: 'ê°•', es: 'rÃ­o' }, keywords: { en: ['flow', 'grand'], ko: ['íë¦„', 'ì›…ì¥í•¨'], es: ['flujo', 'grandeza'] } },
    { hanja: 'æ½¤', hangul: 'ìœ¤', jawon: 'water', meaning: { en: 'to enrich', ko: 'ìœ¤íƒí•˜ë‹¤', es: 'enriquecer' }, keywords: { en: ['prosperity', 'softness'], ko: ['ë²ˆì˜', 'ë¶€ë“œëŸ¬ì›€'], es: ['prosperidad', 'suavidad'] } },
    { hanja: 'æµ·', hangul: 'í•´', jawon: 'water', meaning: { en: 'sea, ocean', ko: 'ë°”ë‹¤', es: 'mar, ocÃ©ano' }, keywords: { en: ['vastness', 'potential'], ko: ['ê´‘í™œí•¨', 'ì ì¬ë ¥'], es: ['inmensidad', 'potencial'] } },
    { hanja: 'æ¾¤', hangul: 'íƒ', jawon: 'water', meaning: { en: 'marsh, benefit', ko: 'ëª», í˜œíƒ', es: 'pantano, beneficio' }, keywords: { en: ['grace', 'abundance'], ko: ['ì€í˜œ', 'í’ìš”'], es: ['gracia', 'abundancia'] } },
    { hanja: 'æ³‰', hangul: 'ì²œ', jawon: 'water', meaning: { en: 'spring, fountain', ko: 'ìƒ˜', es: 'fuente, manantial' }, keywords: { en: ['freshness', 'origin'], ko: ['ì‹ ì„ í•¨', 'ê·¼ì›'], es: ['frescura', 'origen'] } },
    { hanja: 'æµ©', hangul: 'í˜¸', jawon: 'water', meaning: { en: 'vast, great', ko: 'ë„“ë‹¤, í¬ë‹¤', es: 'vasto, grande' }, keywords: { en: ['generosity', 'power'], ko: ['ê´€ëŒ€í•¨', 'í˜'], es: ['generosidad', 'poder'] } },
    { hanja: 'æº', hangul: 'ì›', jawon: 'water', meaning: { en: 'source, origin', ko: 'ê·¼ì›', es: 'fuente, origen' }, keywords: { en: ['beginning', 'wisdom'], ko: ['ì‹œì‘', 'ì§€í˜œ'], es: ['comienzo', 'sabidurÃ­a'] } },
    { hanja: 'æ´›', hangul: 'ë½', jawon: 'water', meaning: { en: 'river name', ko: 'ê°• ì´ë¦„', es: 'nombre de rÃ­o' }, keywords: { en: ['clarity', 'capital'], ko: ['ëª…ë£Œí•¨', 'ìˆ˜ë„'], es: ['claridad', 'capital'] } },
    { hanja: 'æ³°', hangul: 'íƒœ', jawon: 'water', meaning: { en: 'great, peaceful', ko: 'í¬ë‹¤, í‰í™”ë¡­ë‹¤', es: 'grande, pacÃ­fico' }, keywords: { en: ['stability', 'calmness'], ko: ['ì•ˆì •', 'í‰ì˜¨'], es: ['estabilidad', 'calma'] } },
    { hanja: 'æ·³', hangul: 'ìˆœ', jawon: 'water', meaning: { en: 'pure, genuine', ko: 'ìˆœìˆ˜í•˜ë‹¤', es: 'puro, genuino' }, keywords: { en: ['sincerity', 'kindness'], ko: ['ì§„ì‹¤í•¨', 'ì¹œì ˆ'], es: ['sinceridad', 'amabilidad'] } },
    { hanja: 'æ·‘', hangul: 'ìˆ™', jawon: 'water', meaning: { en: 'pure, virtuous', ko: 'ë§‘ë‹¤, ì •ìˆ™í•˜ë‹¤', es: 'pura, virtuosa' }, keywords: { en: ['elegance', 'gentleness'], ko: ['ìš°ì•„í•¨', 'ì˜¨í™”í•¨'], es: ['elegancia', 'dulzura'] } },
    { hanja: 'æ¶µ', hangul: 'í•¨', jawon: 'water', meaning: { en: 'to contain, soak', ko: 'í¬í•¨í•˜ë‹¤, ì –ë‹¤', es: 'contener, empapar' }, keywords: { en: ['tolerance', 'depth'], ko: ['ê´€ìš©', 'ê¹Šì´'], es: ['tolerancia', 'profundidad'] } },
    { hanja: 'æ·µ', hangul: 'ì—°', jawon: 'water', meaning: { en: 'abyss, deep', ko: 'ëª», ê¹Šë‹¤', es: 'abismo, profundo' }, keywords: { en: ['wisdom', 'thoughtfulness'], ko: ['ì§€í˜œ', 'ì‚¬ë ¤ê¹ŠìŒ'], es: ['sabidurÃ­a', 'consideraciÃ³n'] } },
    { hanja: 'æ·‡', hangul: 'ê¸°', jawon: 'water', meaning: { en: 'river in China', ko: 'ê°• ì´ë¦„', es: 'rÃ­o en China' }, keywords: { en: ['vitality', 'cleanliness'], ko: ['í™œë ¥', 'ê¹¨ë—í•¨'], es: ['vitalidad', 'limpieza'] } },
    { hanja: 'æ´²', hangul: 'ì£¼', jawon: 'water', meaning: { en: 'continent, island', ko: 'ëŒ€ë¥™, ì„¬', es: 'continente, isla' }, keywords: { en: ['world', 'foundation'], ko: ['ì„¸ê³„', 'ê¸°ë°˜'], es: ['mundo', 'fundamento'] } },
    // --- Wood Element (æœ¨) --- 30
    { hanja: 'æ—', hangul: 'ë¦¼', jawon: 'wood', meaning: { en: 'forest', ko: 'ìˆ²', es: 'bosque' }, keywords: { en: ['growth', 'vitality'], ko: ['ì„±ì¥', 'í™œë ¥'], es: ['crecimiento', 'vitalidad'] } },
    { hanja: 'ç§€', hangul: 'ìˆ˜', jawon: 'wood', meaning: { en: 'outstanding', ko: 'ë¹¼ì–´ë‚˜ë‹¤', es: 'sobresaliente' }, keywords: { en: ['excellence', 'beauty'], ko: ['íƒì›”í•¨', 'ì•„ë¦„ë‹¤ì›€'], es: ['excelencia', 'belleza'] } },
    { hanja: 'æ ½', hangul: 'ì¬', jawon: 'wood', meaning: { en: 'to plant', ko: 'ì‹¬ë‹¤', es: 'plantar' }, keywords: { en: ['nurture', 'potential'], ko: ['ì–‘ìœ¡', 'ì ì¬ë ¥'], es: ['nutrir', 'potencial'] } },
    { hanja: 'å½¬', hangul: 'ë¹ˆ', jawon: 'wood', meaning: { en: 'refined', ko: 'ë¹›ë‚˜ë‹¤', es: 'refinado' }, keywords: { en: ['culture', 'harmony'], ko: ['ë¬¸í™”', 'ì¡°í™”'], es: ['cultura', 'armonÃ­a'] } },
    { hanja: 'æ ¹', hangul: 'ê·¼', jawon: 'wood', meaning: { en: 'root', ko: 'ë¿Œë¦¬', es: 'raÃ­z' }, keywords: { en: ['foundation', 'strength'], ko: ['ê¸°ì´ˆ', 'í˜'], es: ['fundamento', 'fuerza'] } },
    { hanja: 'æ¤', hangul: 'ì‹', jawon: 'wood', meaning: { en: 'to plant', ko: 'ì„¸ìš°ë‹¤', es: 'establecer' }, keywords: { en: ['establish', 'growth'], ko: ['ì„¤ë¦½', 'ì„±ì¥'], es: ['establecer', 'crecimiento'] } },
    { hanja: 'æ', hangul: 'ì¬', jawon: 'wood', meaning: { en: 'timber, talent', ko: 'ì¬ëª©, ì¬ëŠ¥', es: 'madera, talento' }, keywords: { en: ['ability', 'resource'], ko: ['ëŠ¥ë ¥', 'ìì›'], es: ['habilidad', 'recurso'] } },
    { hanja: 'æ±', hangul: 'ë™', jawon: 'wood', meaning: { en: 'east', ko: 'ë™ìª½', es: 'este' }, keywords: { en: ['beginning', 'hope'], ko: ['ì‹œì‘', 'í¬ë§'], es: ['comienzo', 'esperanza'] } },
    { hanja: 'é‡‡', hangul: 'ì±„', jawon: 'wood', meaning: { en: 'to gather, colorful', ko: 'ìºë‹¤, ì±„ìƒ‰', es: 'recoger, colorido' }, keywords: { en: ['art', 'variety'], ko: ['ì˜ˆìˆ ', 'ë‹¤ì±„ë¡œì›€'], es: ['arte', 'variedad'] } },
    { hanja: 'èŠ', hangul: 'ì§€', jawon: 'wood', meaning: { en: 'iris', ko: 'ì§€ì´ˆ', es: 'iris' }, keywords: { en: ['beauty', 'nobility'], ko: ['ì•„ë¦„ë‹¤ì›€', 'ê³ ê·€í•¨'], es: ['belleza', 'nobleza'] } },
    { hanja: 'è‹±', hangul: 'ì˜', jawon: 'wood', meaning: { en: 'flower, hero', ko: 'ê½ƒ, ì˜ì›…', es: 'flor, hÃ©roe' }, keywords: { en: ['bravery', 'excellence'], ko: ['ìš©ê¸°', 'íƒì›”í•¨'], es: ['valentÃ­a', 'excelencia'] } },
    { hanja: 'è˜­', hangul: 'ë€', jawon: 'wood', meaning: { en: 'orchid', ko: 'ë‚œì´ˆ', es: 'orquÃ­dea' }, keywords: { en: ['elegance', 'purity'], ko: ['ìš°ì•„í•¨', 'ìˆœìˆ˜'], es: ['elegancia', 'pureza'] } },
    { hanja: 'æ', hangul: 'ì±„', jawon: 'wood', meaning: { en: 'talent', ko: 'ì¬ëŠ¥', es: 'talento' }, keywords: { en: ['skill', 'potential'], ko: ['ê¸°ìˆ ', 'ì ì¬ë ¥'], es: ['habilidad', 'potencial'] } },
    { hanja: 'æ©‹', hangul: 'êµ', jawon: 'wood', meaning: { en: 'bridge', ko: 'ë‹¤ë¦¬', es: 'puente' }, keywords: { en: ['connection', 'mediation'], ko: ['ì—°ê²°', 'ì¤‘ì¬'], es: ['conexiÃ³n', 'mediaciÃ³n'] } },
    { hanja: 'ç­–', hangul: 'ì±…', jawon: 'wood', meaning: { en: 'plan, strategy', ko: 'ê³„ì±…', es: 'plan, estrategia' }, keywords: { en: ['wisdom', 'planning'], ko: ['ì§€í˜œ', 'ê³„íš'], es: ['sabidurÃ­a', 'planificaciÃ³n'] } },
    // --- Fire Element (ç«) --- 30
    { hanja: 'ç…¥', hangul: 'í™˜', jawon: 'fire', meaning: { en: 'shining', ko: 'ë¹›ë‚˜ë‹¤', es: 'brillante' }, keywords: { en: ['passion', 'brightness'], ko: ['ì—´ì •', 'ë°ìŒ'], es: ['pasiÃ³n', 'brillo'] } },
    { hanja: 'æ˜ ', hangul: 'ì˜', jawon: 'fire', meaning: { en: 'to reflect', ko: 'ë¹„ì¶”ë‹¤', es: 'reflejar' }, keywords: { en: ['light', 'influence'], ko: ['ë¹›', 'ì˜í–¥ë ¥'], es: ['luz', 'influencia'] } },
    { hanja: 'æ—­', hangul: 'ìš±', jawon: 'fire', meaning: { en: 'rising sun', ko: 'ì•„ì¹¨ í•´', es: 'sol naciente' }, keywords: { en: ['hope', 'energy'], ko: ['í¬ë§', 'ì—ë„ˆì§€'], es: ['esperanza', 'energÃ­a'] } },
    { hanja: 'å¤', hangul: 'í•˜', jawon: 'fire', meaning: { en: 'summer', ko: 'ì—¬ë¦„', es: 'verano' }, keywords: { en: ['vitality', 'activity'], ko: ['í™œë ¥', 'í™œë™'], es: ['vitalidad', 'actividad'] } },
    { hanja: 'å…‰', hangul: 'ê´‘', jawon: 'fire', meaning: { en: 'light, glory', ko: 'ë¹›, ì˜ê´‘', es: 'luz, gloria' }, keywords: { en: ['honor', 'brightness'], ko: ['ëª…ì˜ˆ', 'ë°ìŒ'], es: ['honor', 'brillo'] } },
    { hanja: 'çƒˆ', hangul: 'ë ¬', jawon: 'fire', meaning: { en: 'ardent, fiery', ko: 'ë§µë‹¤, ëœ¨ê²ë‹¤', es: 'ardiente, fogoso' }, keywords: { en: ['passion', 'strength'], ko: ['ì—´ì •', 'í˜'], es: ['pasiÃ³n', 'fuerza'] } },
    { hanja: 'ç„¶', hangul: 'ì—°', jawon: 'fire', meaning: { en: 'to be so, yes', ko: 'ê·¸ëŸ¬í•˜ë‹¤', es: 'ser asÃ­, sÃ­' }, keywords: { en: ['nature', 'affirmation'], ko: ['ìì—°', 'ê¸ì •'], es: ['naturaleza', 'afirmaciÃ³n'] } },
    { hanja: 'ç†¹', hangul: 'í¬', jawon: 'fire', meaning: { en: 'bright, warm', ko: 'ë°ë‹¤, ë”°ëœ»í•˜ë‹¤', es: 'brillante, cÃ¡lido' }, keywords: { en: ['kindness', 'hope'], ko: ['ì¹œì ˆ', 'í¬ë§'], es: ['amabilidad', 'esperanza'] } },
    { hanja: 'æ˜¶', hangul: 'ì°½', jawon: 'fire', meaning: { en: 'bright, long day', ko: 'ë°ë‹¤, í•´ê°€ ê¸¸ë‹¤', es: 'brillante, dÃ­a largo' }, keywords: { en: ['endurance', 'clarity'], ko: ['ì¸ë‚´', 'ëª…í™•í•¨'], es: ['resistencia', 'claridad'] } },
    { hanja: 'ç‡®', hangul: 'ì„­', jawon: 'fire', meaning: { en: 'to blend, harmonize', ko: 'í™”í•©í•˜ë‹¤', es: 'mezclar, armonizar' }, keywords: { en: ['cooperation', 'balance'], ko: ['í˜‘ë ¥', 'ê· í˜•'], es: ['cooperaciÃ³n', 'equilibrio'] } },
    { hanja: 'ç‡ˆ', hangul: 'ë“±', jawon: 'fire', meaning: { en: 'lamp, light', ko: 'ë“±ë¶ˆ', es: 'lÃ¡mpara, luz' }, keywords: { en: ['guidance', 'wisdom'], ko: ['ì•ˆë‚´', 'ì§€í˜œ'], es: ['guÃ­a', 'sabidurÃ­a'] } },
    { hanja: 'ç‚«', hangul: 'í˜„', jawon: 'fire', meaning: { en: 'to shine, glitter', ko: 'ë¹›ë‚˜ë‹¤, ìë‘í•˜ë‹¤', es: 'brillar, relucir' }, keywords: { en: ['talent', 'expression'], ko: ['ì¬ëŠ¥', 'í‘œí˜„'], es: ['talento', 'expresiÃ³n'] } },
    { hanja: 'ç…‡', hangul: 'íœ˜', jawon: 'fire', meaning: { en: 'brilliance', ko: 'ë¹›', es: 'brillo' }, keywords: { en: ['leadership', 'glory'], ko: ['ë¦¬ë”ì‹­', 'ì˜ê´‘'], es: ['liderazgo', 'gloria'] } },
    { hanja: 'ç‚³', hangul: 'ë³‘', jawon: 'fire', meaning: { en: 'bright, glorious', ko: 'ë¹›ë‚˜ë‹¤', es: 'brillante, glorioso' }, keywords: { en: ['achievement', 'fame'], ko: ['ì„±ì·¨', 'ëª…ì„±'], es: ['logro', 'fama'] } },
    { hanja: 'æš–', hangul: 'ë‚œ', jawon: 'fire', meaning: { en: 'warm', ko: 'ë”°ëœ»í•˜ë‹¤', es: 'cÃ¡lido' }, keywords: { en: ['comfort', 'affection'], ko: ['í¸ì•ˆí•¨', 'ì• ì •'], es: ['comodidad', 'afecto'] } },
    // --- Earth Element (åœŸ) --- 30
    { hanja: 'å‡', hangul: 'ê· ', jawon: 'earth', meaning: { en: 'even, balanced', ko: 'ê³ ë¥´ë‹¤', es: 'uniforme, equilibrado' }, keywords: { en: ['stability', 'fairness'], ko: ['ì•ˆì •ì„±', 'ê³µì •í•¨'], es: ['estabilidad', 'justicia'] } },
    { hanja: 'ç¥', hangul: 'ìš°', jawon: 'earth', meaning: { en: 'divine help', ko: 'ë„ì›€', es: 'ayuda divina' }, keywords: { en: ['protection', 'fortune'], ko: ['ë³´í˜¸', 'í–‰ìš´'], es: ['protecciÃ³n', 'fortuna'] } },
    { hanja: 'ä¿¡', hangul: 'ì‹ ', jawon: 'earth', meaning: { en: 'trust, faith', ko: 'ë¯¿ìŒ', es: 'confianza, fe' }, keywords: { en: ['reliability', 'integrity'], ko: ['ì‹ ë¢°ì„±', 'ì„±ì‹¤'], es: ['fiabilidad', 'integridad'] } },
    { hanja: 'å¤', hangul: 'ê³¤', jawon: 'earth', meaning: { en: 'earth principle', ko: 'ë•…', es: 'principio de la tierra' }, keywords: { en: ['nurturing', 'receptivity'], ko: ['ì–‘ìœ¡', 'ìˆ˜ìš©ì„±'], es: ['crianza', 'receptividad'] } },
    { hanja: 'åœ¨', hangul: 'ì¬', jawon: 'earth', meaning: { en: 'to exist, in', ko: 'ìˆë‹¤', es: 'existir, en' }, keywords: { en: ['presence', 'foundation'], ko: ['ì¡´ì¬', 'ê¸°ë°˜'], es: ['presencia', 'fundamento'] } },
    { hanja: 'åœ­', hangul: 'ê·œ', jawon: 'earth', meaning: { en: 'jade tablet', ko: 'ê·œ', es: 'tableta de jade' }, keywords: { en: ['standard', 'nobility'], ko: ['í‘œì¤€', 'ê³ ê·€í•¨'], es: ['estÃ¡ndar', 'nobleza'] } },
    { hanja: 'åŸ', hangul: 'ì„±', jawon: 'earth', meaning: { en: 'castle, wall', ko: 'ì„±', es: 'castillo, muralla' }, keywords: { en: ['protection', 'sturdiness'], ko: ['ë³´í˜¸', 'ê²¬ê³ í•¨'], es: ['protecciÃ³n', 'robustez'] } },
    { hanja: 'å ', hangul: 'ì€', jawon: 'earth', meaning: { en: 'boundary, bank', ko: 'ì–¸ë•, ê²½ê³„', es: 'lÃ­mite, orilla' }, keywords: { en: ['stability', 'expanse'], ko: ['ì•ˆì •', 'ê´‘í™œí•¨'], es: ['estabilidad', 'extensiÃ³n'] } },
    { hanja: 'åŸº', hangul: 'ê¸°', jawon: 'earth', meaning: { en: 'foundation, base', ko: 'ê¸°ì´ˆ, í„°', es: 'fundamento, base' }, keywords: { en: ['principle', 'potential'], ko: ['ì›ì¹™', 'ì ì¬ë ¥'], es: ['principio', 'potencial'] } },
    { hanja: 'åŸ¹', hangul: 'ë°°', jawon: 'earth', meaning: { en: 'to cultivate', ko: 'ë¶ë‹ìš°ë‹¤', es: 'cultivar' }, keywords: { en: ['nurture', 'growth'], ko: ['ì–‘ìœ¡', 'ì„±ì¥'], es: ['nutrir', 'crecimiento'] } },
    { hanja: 'åº¸', hangul: 'ìš©', jawon: 'earth', meaning: { en: 'common, to use', ko: 'ì“°ë‹¤, í‰ë²”í•˜ë‹¤', es: 'comÃºn, usar' }, keywords: { en: ['harmony', 'steadiness'], ko: ['ì¡°í™”', 'ê¾¸ì¤€í•¨'], es: ['armonÃ­a', 'constancia'] } },
    { hanja: 'å£', hangul: 'ì›', jawon: 'earth', meaning: { en: 'wall, fence', ko: 'ë‹´', es: 'muro, valla' }, keywords: { en: ['support', 'protection'], ko: ['ì§€ì›', 'ë³´í˜¸'], es: ['apoyo', 'protecciÃ³n'] } },
    { hanja: 'è­½', hangul: 'ì˜ˆ', jawon: 'earth', meaning: { en: 'fame, reputation', ko: 'ëª…ì˜ˆ', es: 'fama, reputaciÃ³n' }, keywords: { en: ['honor', 'respect'], ko: ['ëª…ì˜ˆ', 'ì¡´ê²½'], es: ['honor', 'respeto'] } },
    { hanja: 'é™', hangul: 'ìŠ¹', jawon: 'earth', meaning: { en: 'to rise, advance', ko: 'ì˜¤ë¥´ë‹¤', es: 'ascender, avanzar' }, keywords: { en: ['promotion', 'success'], ko: ['ìŠ¹ì§„', 'ì„±ê³µ'], es: ['ascenso', 'Ã©xito'] } },
    { hanja: 'äº', hangul: 'ì•„', jawon: 'earth', meaning: { en: 'second, Asia', ko: 'ë²„ê¸ˆ, ì•„ì‹œì•„', es: 'segundo, Asia' }, keywords: { en: ['center', 'foundation'], ko: ['ì¤‘ì‹¬', 'ê¸°ë°˜'], es: ['centro', 'fundamento'] } },
    // --- Metal Element (é‡‘) --- 30
    { hanja: 'ç‘', hangul: 'ì„œ', jawon: 'metal', meaning: { en: 'auspicious', ko: 'ìƒì„œë¡­ë‹¤', es: 'auspicioso' }, keywords: { en: ['blessing', 'precious'], ko: ['ì¶•ë³µ', 'ê·€ì¤‘í•¨'], es: ['bendiciÃ³n', 'precioso'] } },
    { hanja: 'å³»', hangul: 'ì¤€', jawon: 'metal', meaning: { en: 'high mountain', ko: 'ë†’ì€ ì‚°', es: 'montaÃ±a alta' }, keywords: { en: ['strength', 'principle'], ko: ['ê°•ì¸í•¨', 'ì›ì¹™'], es: ['fuerza', 'principio'] } },
    { hanja: 'éŒ«', hangul: 'ì„', jawon: 'metal', meaning: { en: 'to bestow, tin', ko: 'ì£¼ì„, í•˜ì‚¬í•˜ë‹¤', es: 'otorgar, estaÃ±o' }, keywords: { en: ['granting', 'value'], ko: ['ìˆ˜ì—¬', 'ê°€ì¹˜'], es: ['concesiÃ³n', 'valor'] } },
    { hanja: 'ç²', hangul: 'ë ¹', jawon: 'metal', meaning: { en: 'sound of jade', ko: 'ì˜¥ ì†Œë¦¬', es: 'sonido de jade' }, keywords: { en: ['clarity', 'bright'], ko: ['ëª…ë£Œí•¨', 'ë°ìŒ'], es: ['claridad', 'brillante'] } },
    { hanja: 'éˆ´', hangul: 'ë ¹', jawon: 'metal', meaning: { en: 'bell', ko: 'ë°©ìš¸', es: 'campana' }, keywords: { en: ['alertness', 'sound'], ko: ['ê¸°ë¯¼í•¨', 'ì†Œë¦¬'], es: ['alerta', 'sonido'] } },
    { hanja: 'éˆº', hangul: 'ì˜¥', jawon: 'metal', meaning: { en: 'treasure', ko: 'ë³´ë¬¼', es: 'tesoro' }, keywords: { en: ['precious', 'hardness'], ko: ['ê·€ì¤‘í•¨', 'ê²¬ê³ í•¨'], es: ['precioso', 'dureza'] } },
    { hanja: 'éŒš', hangul: 'ìŸ', jawon: 'metal', meaning: { en: 'sound of metal', ko: 'ì‡³ì†Œë¦¬', es: 'sonido de metal' }, keywords: { en: ['excellent', 'sharp'], ko: ['ë›°ì–´ë‚¨', 'ë‚ ì¹´ë¡œì›€'], es: ['excelente', 'agudo'] } },
    { hanja: 'é­', hangul: 'ì§„', jawon: 'metal', meaning: { en: 'to guard', ko: 'ì§„ì••í•˜ë‹¤', es: 'guardar' }, keywords: { en: ['stability', 'leadership'], ko: ['ì•ˆì •', 'ë¦¬ë”ì‹­'], es: ['estabilidad', 'liderazgo'] } },
    { hanja: 'é‰‰', hangul: 'í˜„', jawon: 'metal', meaning: { en: 'tripod lug, wise', ko: 'ì†¥ê·€, ì§€í˜œ', es: 'asa de trÃ­pode, sabio' }, keywords: { en: ['wisdom', 'support'], ko: ['ì§€í˜œ', 'ì§€ì§€'], es: ['sabidurÃ­a', 'apoyo'] } },
    { hanja: 'éŠ€', hangul: 'ì€', jawon: 'metal', meaning: { en: 'silver', ko: 'ì€', es: 'plata' }, keywords: { en: ['value', 'purity'], ko: ['ê°€ì¹˜', 'ìˆœìˆ˜'], es: ['valor', 'pureza'] } },
    { hanja: 'é¾', hangul: 'ì¢…', jawon: 'metal', meaning: { en: 'bell, cup', ko: 'ì‡ ë¶, ì”', es: 'campana, copa' }, keywords: { en: ['gathering', 'center'], ko: ['ëª¨ì„', 'ì¤‘ì‹¬'], es: ['reuniÃ³n', 'centro'] } },
    { hanja: 'éŠ', hangul: 'ë ¨', jawon: 'metal', meaning: { en: 'to refine, train', ko: 'ë‹¨ë ¨í•˜ë‹¤', es: 'refinar, entrenar' }, keywords: { en: ['discipline', 'perfection'], ko: ['ë‹¨ë ¨', 'ì™„ë²½'], es: ['disciplina', 'perfecciÃ³n'] } },
    { hanja: 'å®°', hangul: 'ì¬', jawon: 'metal', meaning: { en: 'to rule', ko: 'ì¬ìƒ', es: 'gobernar' }, keywords: { en: ['leadership', 'judgment'], ko: ['ë¦¬ë”ì‹­', 'íŒë‹¨ë ¥'], es: ['liderazgo', 'juicio'] } },
    { hanja: 'å‰›', hangul: 'ê°•', jawon: 'metal', meaning: { en: 'strong, firm', ko: 'êµ³ì„¸ë‹¤', es: 'fuerte, firme' }, keywords: { en: ['courage', 'integrity'], ko: ['ìš©ê¸°', 'ì²­ë ´'], es: ['coraje', 'integridad'] } },
    { hanja: 'å‰µ', hangul: 'ì°½', jawon: 'metal', meaning: { en: 'to create, begin', ko: 'ë¹„ë¡¯í•˜ë‹¤, ë§Œë“¤ë‹¤', es: 'crear, comenzar' }, keywords: { en: ['innovation', 'initiative'], ko: ['í˜ì‹ ', 'ì§„ì·¨'], es: ['innovaciÃ³n', 'iniciativa'] } }
].map(h => ({...h, good: true, strokes: h.strokes || 10 }));


const translations = {
    en: {
        pageTitle: "SoulName: Your K-Name Destiny", introText: "Discover your personalized Korean name, crafted from the cosmic blueprint of your birth date and time.", findNameButton: "Find My K-Name", resultTitle: "Your Saju Profile & Name Recommendations", generatedFor: "Generated for", sajuReadingTitle: "1. Your Saju Analysis", fiveElementsDistributionTitle: "2. Five Elements Distribution", recommendedNamesTitle: "3. Recommended Names to Harmonize Your Energy", recommendation: "Recommendation", timeInfo: "For a more precise analysis, knowing the exact time of birth is recommended.", unknownTime: "Unknown", yearLabel: "Year", monthLabel: "Month", dayLabel: "Day", hourLabel: "Hour", minuteLabel: "Minute", genderLabel: "Gender", male: "Male", female: "Female",
        privacyPolicy: "Privacy Policy", termsOfService: "Terms of Service", close: "Close", entertainmentOnly: "For entertainment purposes only. SoulName: Your K-Name Destiny Â© 2024.",
        privacyText: "We do not collect, store, or share any personal information you enter. All data, including your birth date and time, is processed only within your browser and is never sent to our servers. Your privacy is fully protected.",
        termsText: "This service is provided for entertainment purposes only. The analyses and name recommendations are based on simplified principles of Saju Myeongrihak and should not be taken as professional advice. By using this service, you agree that the developers are not liable for any decisions made based on the information provided.",
        detailLink: "Already have a name? See how well it harmonizes with your Saju!",
        yearError: "Please enter a year between 1940-2040.",
        dayError: "Please enter a valid day.",
        elements: { wood: 'Wood', fire: 'Fire', earth: 'Earth', metal: 'Metal', water: 'Water' },
        strengths: { strong: 'strong', weak: 'weak' },
        sajuAnalysis: {
            dayMasterIntro: (d, e) => `Your Saju's core identity, the "Day Master," is <strong>${d} (${e})</strong>.`,
            dayMasterDesc: {
                'ç”²': "This represents a tall, sturdy Tree, giving you natural leadership qualities, a progressive spirit, and a desire to grow and achieve.",
                'ä¹™': "This embodies a flexible Flower or Vine, indicating adaptability, strong vitality, and a charming, sociable nature.",
                'ä¸™': "You are like the brilliant Sun, full of passion, generosity, and a bright energy that illuminates everything around you.",
                'ä¸': "This is the warm, gentle light of a Candle or the Stars, suggesting a refined, sensitive nature with deep insight and warmth.",
                'æˆŠ': "You represent a vast, immovable Mountain, making you trustworthy, stable, and a central figure who can support others.",
                'å·±': "This is fertile, nurturing Earth, indicating a gentle, receptive, and cautious personality that can cultivate great things.",
                'åºš': "You embody strong, unrefined Metal or a powerful Sword, giving you a decisive, loyal, and principled nature with a sharp mind.",
                'è¾›': "You are like a precious, polished Gem, suggesting a sophisticated, aesthetically-minded, and perfectionistic personality.",
                'å£¬': "This represents a great Ocean or River, indicating a wise, flexible, and all-embracing nature with great potential.",
                'ç™¸': "This is the gentle Rain or Dew, suggesting an intelligent, creative, and sensitive personality with a talent for nurturing ideas."
            },
            sajuBalance: (s, b) => `Analysis shows your Day Master is <strong>${s}</strong>... your Saju benefits from <strong>${b.join(' and ')}</strong>.`,
            nameIntro: (n) => `We recommend <strong>${n.roman} (${n.hangul}, <span class="hanja">${n.hanja}</span>)</strong>. Hereâ€™s why:`,
            firstHanja: (h, e) => `The character <span class="hanja">${h.hanja}</span> means '<strong>${h.meaning.en}</strong>'. Its essence is <strong>${e}</strong>...`,
            secondHanja: (h, e) => `The character <span class="hanja">${h.hanja}</span> signifies '<strong>${h.meaning.en}</strong>'. It resonates with <strong>${e}</strong> energy...`,
            together: (n, h1, h2) => `Together, <strong>${n.roman}</strong> creates "<em>${h1.keywords.en[0]} and ${h2.keywords.en[1]}</em>"...`
        }
    },
    ko: {
        pageTitle: "ì†Œìš¸ë„¤ì„: ë‹¹ì‹ ì˜ ìš´ëª…ì„ ë‹´ì€ ì´ë¦„", introText: "ìƒë…„ì›”ì¼ì‹œì— ë‹´ê¸´ ë‹¹ì‹ ì˜ ìš°ì£¼ì  ì²­ì‚¬ì§„ìœ¼ë¡œ ë§Œë“œëŠ”, ë‹¹ì‹ ë§Œì„ ìœ„í•œ í•œêµ­ ì´ë¦„ì„ ì°¾ì•„ë³´ì„¸ìš”.", findNameButton: "ë‚´ ì´ë¦„ ì°¾ê¸°", resultTitle: "ì‚¬ì£¼ ë¶„ì„ ë° ì´ë¦„ ì¶”ì²œ", generatedFor: "ìƒë…„ì›”ì¼", sajuReadingTitle: "1. ì‚¬ì£¼ ë¶„ì„", fiveElementsDistributionTitle: "2. ì˜¤í–‰ ë¶„í¬", recommendedNamesTitle: "3. ìš´ëª…ì„ ì¡°í™”ë¡­ê²Œ í•  ì¶”ì²œ ì´ë¦„", recommendation: "ì¶”ì²œ", timeInfo: "ì •í™•í•œ ì¶œìƒ ì‹œê°„ì„ ì…ë ¥í•˜ë©´ ë” ì •ë°€í•œ ë¶„ì„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.", unknownTime: "ëª¨ë¦„", yearLabel: "ì—°ë„", monthLabel: "ì›”", dayLabel: "ì¼", hourLabel: "ì‹œ", minuteLabel: "ë¶„", genderLabel: "ì„±ë³„", male: "ë‚¨ì„±", female: "ì—¬ì„±",
        privacyPolicy: "ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨", termsOfService: "ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€", close: "ë‹«ê¸°", entertainmentOnly: "ì˜¤ë½ ëª©ì ìœ¼ë¡œë§Œ ì œê³µë©ë‹ˆë‹¤. SoulName: Your K-Name Destiny Â© 2024.",
        privacyText: "ë‹¹ì‚¬ê°€ ìˆ˜ì§‘, ì €ì¥ ë˜ëŠ” ê³µìœ í•˜ëŠ” ê°œì¸ ì •ë³´ëŠ” ì—†ìŠµë‹ˆë‹¤. ìƒë…„ì›”ì¼ì„ í¬í•¨í•œ ëª¨ë“  ë°ì´í„°ëŠ” ë¸Œë¼ìš°ì € ë‚´ì—ì„œë§Œ ì²˜ë¦¬ë˜ë©° ì„œë²„ë¡œ ì „ì†¡ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê°œì¸ ì •ë³´ëŠ” ì™„ë²½í•˜ê²Œ ë³´í˜¸ë©ë‹ˆë‹¤.",
        termsText: "ë³¸ ì„œë¹„ìŠ¤ëŠ” ì˜¤ë½ ëª©ì ìœ¼ë¡œë§Œ ì œê³µë©ë‹ˆë‹¤. ë¶„ì„ ë° ì´ë¦„ ì¶”ì²œì€ ì‚¬ì£¼ëª…ë¦¬í•™ì˜ ë‹¨ìˆœí™”ëœ ì›ì¹™ì— ê·¼ê±°í•˜ë¯€ë¡œ ì „ë¬¸ì ì¸ ì¡°ì–¸ìœ¼ë¡œ ê°„ì£¼ë˜ì–´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤. ë³¸ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ê·€í•˜ëŠ” ì œê³µëœ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ëª¨ë“  ê²°ì •ì— ëŒ€í•´ ê°œë°œìê°€ ì±…ì„ì„ ì§€ì§€ ì•ŠëŠ”ë‹¤ëŠ” ë° ë™ì˜í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.",
        detailLink: "ì§€ê¸ˆ ë§Œë“  ì´ë¦„ê³¼ ì‚¬ì£¼ì˜ ì¡°í™”ê°€ ê¶ê¸ˆí•˜ë‹¤ë©´ í´ë¦­!",
        yearError: "1940-2040ë…„ ì‚¬ì´ì˜ ì—°ë„ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.",
        dayError: "ìœ íš¨í•œ ë‚ ì§œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.",
        elements: { wood: 'ëª©(æœ¨)', fire: 'í™”(ç«)', earth: 'í† (åœŸ)', metal: 'ê¸ˆ(é‡‘)', water: 'ìˆ˜(æ°´)' },
        strengths: { strong: 'ê°•í•œ', weak: 'ì•½í•œ' },
        sajuAnalysis: {
            dayMasterIntro: (d, e) => `ë‹¹ì‹ ì˜ "ì¼ê°„(æ—¥å¹²)"ì€ <strong>${d} (${e})</strong> ì…ë‹ˆë‹¤.`,
            dayMasterDesc: {
                'ç”²': 'í¬ê³  íŠ¼íŠ¼í•œ ë‚˜ë¬´ë¥¼ ìƒì§•í•˜ë©°, íƒ€ê³ ë‚œ ë¦¬ë”ì‹­ê³¼ ì§„ì·¨ì ì¸ ì •ì‹ , ì„±ì¥ê³¼ ì„±ì·¨ì— ëŒ€í•œ ì—´ë§ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.',
                'ä¹™': 'ìœ ì—°í•œ ê½ƒì´ë‚˜ ë©êµ´ì„ ìƒì§•í•˜ë©°, ë›°ì–´ë‚œ ì ì‘ë ¥ê³¼ ê°•í•œ ìƒëª…ë ¥, ë§¤ë ¥ì ì´ê³  ì‚¬êµì ì¸ ì„±í–¥ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.',
                'ä¸™': 'ë¹›ë‚˜ëŠ” íƒœì–‘ê³¼ ê°™ì•„, ì—´ì •ê³¼ ê´€ëŒ€í•¨, ê·¸ë¦¬ê³  ì£¼ë³€ ëª¨ë“  ê²ƒì„ ë¹„ì¶”ëŠ” ë°ì€ ì—ë„ˆì§€ë¥¼ ì§€ë…”ìŠµë‹ˆë‹¤.',
                'ä¸': 'ë”°ëœ»í•˜ê³  ì€ì€í•œ ì´›ë¶ˆì´ë‚˜ ë³„ë¹›ìœ¼ë¡œ, ê¹Šì€ í†µì°°ë ¥ê³¼ ì˜¨ê¸°ë¥¼ ì§€ë‹Œ ì„¬ì„¸í•˜ê³  ê°ì„±ì ì¸ ë³¸ì„±ì„ ì•”ì‹œí•©ë‹ˆë‹¤.',
                'æˆŠ': 'í¬ê³  ì›€ì§ì´ì§€ ì•ŠëŠ” ì‚°ì„ ìƒì§•í•˜ì—¬, ì‹ ë¢°í•  ìˆ˜ ìˆê³  ì•ˆì •ì ì´ë©° ë‹¤ë¥¸ ì‚¬ëŒë“¤ì„ ì§€ì§€í•  ìˆ˜ ìˆëŠ” ì¤‘ì‹¬ì ì¸ ì¸ë¬¼ì„ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.',
                'å·±': 'ë§Œë¬¼ì„ í‚¤ìš°ëŠ” ë¹„ì˜¥í•œ ë•…ìœ¼ë¡œ, ìœ„ëŒ€í•œ ê²ƒì„ ì¼êµ´ ìˆ˜ ìˆëŠ” ë¶€ë“œëŸ½ê³  ìˆ˜ìš©ì ì´ë©° ì‹ ì¤‘í•œ ì„±ê²©ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.',
                'åºš': 'ê°•í•˜ê³  ì œë ¨ë˜ì§€ ì•Šì€ ê¸ˆì†ì´ë‚˜ ê°•ë ¥í•œ ì¹¼ì„ ìƒì§•í•˜ë©°, ê²°ë‹¨ë ¥ ìˆê³  ì˜ë¦¬ ìˆìœ¼ë©° ë‚ ì¹´ë¡œìš´ ì •ì‹ ì„ ê°€ì§„ ë³¸ì„±ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.',
                'è¾›': 'ê·€í•˜ê³  ì˜ ë‹¦ì¸ ë³´ì„ê³¼ ê°™ì•„, ì„¸ë ¨ë˜ê³  ë¯¸ì  ê°ê°ì´ ë›°ì–´ë‚˜ë©° ì™„ë²½ì£¼ì˜ì ì¸ ì„±í–¥ì„ ì•”ì‹œí•©ë‹ˆë‹¤.',
                'å£¬': 'ê±°ëŒ€í•œ ë°”ë‹¤ë‚˜ ê°•ì„ ìƒì§•í•˜ë©°, ìœ„ëŒ€í•œ ì ì¬ë ¥ì„ ì§€ë‹Œ ì§€í˜œë¡­ê³  ìœ ì—°í•˜ë©° ëª¨ë“  ê²ƒì„ í¬ìš©í•˜ëŠ” ë³¸ì„±ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.',
                'ç™¸': 'ë¶€ë“œëŸ¬ìš´ ë¹„ë‚˜ ì´ìŠ¬ì„ ìƒì§•í•˜ë©°, ì§€ì ì´ê³  ì°½ì˜ì ì´ë©° ì•„ì´ë””ì–´ë¥¼ í‚¤ìš°ëŠ” ì¬ëŠ¥ì„ ê°€ì§„ ì„¬ì„¸í•œ ì„±ê²©ì„ ì•”ì‹œí•©ë‹ˆë‹¤.'
            },
            sajuBalance: (s, b) => `ë‹¹ì‹ ì˜ ì¼ê°„ì€ <strong>${s}</strong> ê²½í–¥ì„ ë³´ì…ë‹ˆë‹¤... <strong>${b.join('ê³¼ ')}</strong>ì˜ ê¸°ìš´ì´ ê°€ì¥ ìœ ìš©í•©ë‹ˆë‹¤.`,
            nameIntro: (n) => `<strong>${n.hangul} (<span class="hanja">${n.hanja}</span>, ${n.roman})</strong>ì„ ì¶”ì²œí•©ë‹ˆë‹¤. ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:`,
            firstHanja: (h, e) => `<span class="hanja">${h.hanja}</span>('${h.hangul}')ì€ '<strong>${h.meaning.ko}</strong>'ì„ ì˜ë¯¸í•˜ë©° ìì›ì˜¤í–‰ì€ <strong>${e}</strong>ìœ¼ë¡œ...`,
            secondHanja: (h, e) => `<span class="hanja">${h.hanja}</span>('${h.hangul}')ì€ '<strong>${h.meaning.ko}</strong>'ì„ ì˜ë¯¸í•˜ë©° <strong>${e}</strong>ì˜ ê¸°ìš´ê³¼ ê³µëª…í•©ë‹ˆë‹¤...`,
            together: (n, h1, h2) => `<strong>'${n.hangul}'</strong>ì€ "<em>${h1.keywords.ko[0]}ê³¼ ${h2.keywords.ko[1]}</em>"ì´ë¼ëŠ” ì´ë¯¸ì§€ë¥¼ ë§Œë“­ë‹ˆë‹¤...`
        }
    },
    es: {
        pageTitle: "SoulName: Tu Nombre Coreano del Destino", introText: "Descubre tu nombre coreano personalizado, creado a partir del plan cÃ³smico de tu fecha y hora de nacimiento.", findNameButton: "Encontrar mi Nombre Coreano", resultTitle: "Tu Perfil Saju y Nombres Recomendados", generatedFor: "Generado para", sajuReadingTitle: "1. Tu AnÃ¡lisis Saju", fiveElementsDistributionTitle: "2. DistribuciÃ³n de los Cinco Elementos", recommendedNamesTitle: "3. Nombres Recomendados para Armonizar tu EnergÃ­a", recommendation: "RecomendaciÃ³n", timeInfo: "Para un anÃ¡lisis mÃ¡s preciso, se recomienda saber la hora exacta de nacimiento.", unknownTime: "No sÃ©", yearLabel: "AÃ±o", monthLabel: "Mes", dayLabel: "DÃ­a", hourLabel: "Hora", minuteLabel: "Minuto", genderLabel: "GÃ©nero", male: "Masculino", female: "Femenino",
        privacyPolicy: "PolÃ­tica de Privacidad", termsOfService: "TÃ©rminos de Servicio", close: "Cerrar", entertainmentOnly: "Solo para fines de entretenimiento. SoulName: Tu Nombre Coreano del Destino Â© 2024.",
        privacyText: "No recopilamos, almacenamos ni compartimos ninguna informaciÃ³n personal que ingrese. Todos los datos, incluida su fecha y hora de nacimiento, se procesan solo dentro de su navegador y nunca se envÃ­an a nuestros servidores. Su privacidad estÃ¡ totalmente protegida.",
        termsText: "Este servicio se proporciona Ãºnicamente con fines de entretenimiento. Los anÃ¡lisis y las recomendaciones de nombres se basan en principios simplificados de Saju Myeongrihak y no deben tomarse como un consejo profesional. Al utilizar este servicio, usted acepta que los desarrolladores no son responsables de ninguna decisiÃ³n tomada en base a la informaciÃ³n proporcionada.",
        detailLink: "Â¿Ya tienes un nombre? Â¡Descubre quÃ© tan bien armoniza con tu Saju!",
        yearError: "Por favor, ingrese un aÃ±o entre 1940-2040.",
        dayError: "Por favor, ingrese un dÃ­a vÃ¡lido.",
        elements: { wood: 'Madera', fire: 'Fuego', earth: 'Tierra', metal: 'Metal', water: 'Agua' },
        strengths: { strong: 'fuerte', weak: 'dÃ©bil' },
        sajuAnalysis: {
            dayMasterIntro: (d, e) => `Tu "Maestro del DÃ­a", es <strong>${d} (${e})</strong>.`,
            dayMasterDesc: {
                'ç”²': "Representa un Ãrbol alto y robusto, dÃ¡ndote cualidades de liderazgo natural, un espÃ­ritu progresista y un deseo de crecer y alcanzar metas.",
                'ä¹™': "Encarna una Flor o Enredadera flexible, lo que indica adaptabilidad, gran vitalidad y una naturaleza encantadora y sociable.",
                'ä¸™': "Eres como el Sol brillante, lleno de pasiÃ³n, generosidad y una energÃ­a radiante que ilumina todo a tu alrededor.",
                'ä¸': "Es la luz cÃ¡lida y suave de una Vela o las Estrellas, sugiriendo una naturaleza refinada y sensible con una profunda perspicacia y calidez.",
                'æˆŠ': "Representas una MontaÃ±a vasta e inamovible, lo que te hace digno de confianza, estable y una figura central que puede apoyar a otros.",
                'å·±': "Es la Tierra fÃ©rtil y nutritiva, lo que indica una personalidad amable, receptiva y cautelosa que puede cultivar grandes cosas.",
                'åºš': "Encarnas un Metal fuerte y sin refinar o una Espada poderosa, lo que te da una naturaleza decidida, leal y de principios con una mente aguda.",
                'è¾›': "Eres como una Gema preciosa y pulida, lo que sugiere una personalidad sofisticada, con mentalidad estÃ©tica y perfeccionista.",
                'å£¬': "Representa un gran OcÃ©ano o RÃ­o, lo que indica una naturaleza sabia, flexible y que todo lo abarca con un gran potencial.",
                'ç™¸': "Es la Lluvia o el RocÃ­o suave, lo que sugiere una personalidad inteligente, creativa y sensible con talento para nutrir ideas."
            },
            sajuBalance: (s, b) => `Tu Maestro del DÃ­a es <strong>${s}</strong>... tu Saju se beneficia de <strong>${b.join(' y ')}</strong>.`,
            nameIntro: (n) => `Recomendamos <strong>${n.roman} (${n.hangul}, <span class="hanja">${n.hanja}</span>)</strong>. He aquÃ­ por quÃ©:`,
            firstHanja: (h, e) => `El carÃ¡cter <span class="hanja">${h.hanja}</span> significa '<strong>${h.meaning.es}</strong>'. Su esencia es <strong>${e}</strong>...`,
            secondHanja: (h, e) => `El carÃ¡cter <span class="hanja">${h.hanja}</span> significa '<strong>${h.meaning.es}</strong>'. Resuena con la energÃ­a de <strong>${e}</strong>...`,
            together: (n, h1, h2) => `Juntos, <strong>${n.roman}</strong> crea la imagen de "<em>${h1.keywords.es[0]} y ${h2.keywords.es[1]}</em>"...`
        }
    }
};

// ===================================================================================
// II. SAJU NAMER ENGINE - CORE LOGIC
// ===================================================================================

class SajuNamer {
    constructor() {
        this.Stems = ['ç”²', 'ä¹™', 'ä¸™', 'ä¸', 'æˆŠ', 'å·±', 'åºš', 'è¾›', 'å£¬', 'ç™¸'];
        this.Branches = ['å­', 'ä¸‘', 'å¯…', 'å¯', 'è¾°', 'å·³', 'åˆ', 'æœª', 'ç”³', 'é…‰', 'æˆŒ', 'äº¥'];
        this.Ganji = [];
        for (let i = 0; i < 60; i++) { this.Ganji.push(this.Stems[i % 10] + this.Branches[i % 12]); }
        this.ElementMap = { 'ç”²':'wood', 'ä¹™':'wood', 'å¯…':'wood', 'å¯':'wood', 'ä¸™':'fire', 'ä¸':'fire', 'å·³':'fire', 'åˆ':'fire', 'æˆŠ':'earth', 'å·±':'earth', 'ä¸‘':'earth', 'è¾°':'earth', 'æœª':'earth', 'æˆŒ':'earth', 'åºš':'metal', 'è¾›':'metal', 'ç”³':'metal', 'é…‰':'metal', 'å£¬':'water', 'ç™¸':'water', 'å­':'water', 'äº¥':'water' };
        this.MonthBranches = ['å¯…', 'å¯', 'è¾°', 'å·³', 'åˆ', 'æœª', 'ç”³', 'é…‰', 'æˆŒ', 'äº¥', 'å­', 'ä¸‘'];
    }
    
    _countElements(saju) {
        const counts = { wood: 0, fire: 0, earth: 0, metal: 0, water: 0 };
        const sajuString = saju.year + saju.month + saju.day + (saju.hour || '');
        for (const char of sajuString) { const element = this.ElementMap[char]; if (element) { counts[element]++; } }
        return counts;
    }

    analyze(year, month, day, hour) {
        const saju = this._calculateSaju(year, month, day, hour);
        const elementCounts = this._countElements(saju);
        const dayMasterChar = saju.day[0];
        const dayMasterElement = this.ElementMap[dayMasterChar];
        const monthBranchElement = this.ElementMap[saju.month[1]];
        const strengtheningElements = { wood: ['water', 'wood'], fire: ['wood', 'fire'], earth: ['fire', 'earth'], metal: ['earth', 'metal'], water: ['metal', 'water'] };
        const isStrong = strengtheningElements[dayMasterElement].includes(monthBranchElement);
        const strength = isStrong ? 'strong' : 'weak';
        let beneficialElements = [];
        const fiveElementsCycle = ['wood', 'fire', 'earth', 'metal', 'water'];
        const dayMasterIndex = fiveElementsCycle.indexOf(dayMasterElement);
        if (isStrong) { beneficialElements.push(fiveElementsCycle[(dayMasterIndex + 1) % 5]); beneficialElements.push(fiveElementsCycle[(dayMasterIndex + 3) % 5]); } else { beneficialElements.push(fiveElementsCycle[(dayMasterIndex + 4) % 5]); beneficialElements.push(dayMasterElement); }
        return { saju, dayMasterChar, dayMasterElement, strength, beneficialElements, elementCounts };
    }

    generateNames(analysisResult, count = 2) {
        const { beneficialElements } = analysisResult;
        const recommendedNames = [];
        let usedHanjaPairs = new Set();
        for (let i = 0; i < count; i++) {
            const primaryElement = beneficialElements[i % beneficialElements.length];
            const firstHanjaPool = HanjaInfo.filter(h => h.jawon === primaryElement && h.good);
            if (firstHanjaPool.length === 0) continue;
            for(let j=0; j<10; j++) {
                const firstHanja = firstHanjaPool[Math.floor(Math.random() * firstHanjaPool.length)];
                const secondElement = beneficialElements[(i + 1) % beneficialElements.length];
                const secondHanjaPool = HanjaInfo.filter(h => (h.jawon === primaryElement || h.jawon === secondElement) && h.good && h.hanja !== firstHanja.hanja);
                if (secondHanjaPool.length === 0) continue;
                const secondHanja = secondHanjaPool[Math.floor(Math.random() * secondHanjaPool.length)];
                const pairKey = [firstHanja.hanja, secondHanja.hanja].sort().join('');
                if (!usedHanjaPairs.has(pairKey)) {
                     recommendedNames.push({ hangul: firstHanja.hangul + secondHanja.hangul, hanja: firstHanja.hanja + secondHanja.hanja, roman: this._romanize(firstHanja.hangul) + '-' + this._romanize(secondHanja.hangul), components: [firstHanja, secondHanja] });
                     usedHanjaPairs.add(pairKey);
                     break;
                }
            }
        }
        return recommendedNames;
    }

    generateExplanation(analysisResult, recommendedName, lang = 'en') {
        const { dayMasterChar, dayMasterElement, strength, beneficialElements } = analysisResult;
        const [h1, h2] = recommendedName.components;
        const trans = translations[lang] || translations['en'];
        const t = trans.sajuAnalysis;
        const elToString = (el) => trans.elements[el];
        const strengthToString = (str) => trans.strengths[str];
        const analysisSummary = `<p>${t.dayMasterIntro(dayMasterChar, elToString(dayMasterElement))}</p><p>${t.dayMasterDesc[dayMasterChar]}</p><p>${t.sajuBalance(strengthToString(strength), beneficialElements.map(elToString))}</p>`;
        const nameExplanation = `<p class="mb-2">${t.nameIntro(recommendedName)}</p><ul class="list-disc list-inside space-y-2 pl-2"><li>${t.firstHanja(h1, elToString(h1.jawon))}</li><li>${t.secondHanja(h2, elToString(h2.jawon))}</li></ul><p class="mt-3">${t.together(recommendedName, h1, h2)}</p>`;
        return { analysisSummary, nameExplanation };
    }

    _calculateSaju(year, month, day, hour) {
        const yearGanji = this.Ganji[(year - 1924 + 60) % 60];
        const solarMonthIndex = (month + 10) % 12;
        const monthBranch = this.MonthBranches[solarMonthIndex];
        const yearStem = yearGanji[0];
        const HourStems = { 'ç”²':'ç”²', 'ä¹™':'ä¸™', 'ä¸™':'æˆŠ', 'ä¸':'åºš', 'æˆŠ':'å£¬', 'å·±':'ç”²', 'åºš':'ä¸™', 'è¾›':'æˆŠ', 'å£¬':'åºš', 'ç™¸':'å£¬' };
        let monthStemIndex = this.Stems.indexOf(HourStems[yearStem[0]]);
        monthStemIndex = (monthStemIndex + solarMonthIndex) % 10;
        const monthGanji = this.Stems[monthStemIndex] + monthBranch;
        const epoch = new Date(1940, 0, 1);
        const targetDate = new Date(year, month - 1, day);
        const diffDays = Math.floor((targetDate - epoch) / (1000 * 60 * 60 * 24));
        const dayGanji = this.Ganji[(55 + diffDays) % 60];
        let hourGanji = null;
        if (hour !== -1) { const hourBranchIndex = Math.floor((hour + 1) / 2) % 12; const hourBranch = this.Branches[hourBranchIndex]; let hourStemIndex = this.Stems.indexOf(HourStems[dayGanji[0]]); hourStemIndex = (hourStemIndex + hourBranchIndex) % 10; hourGanji = this.Stems[hourStemIndex] + hourBranch; }
        return { year: yearGanji, month: monthGanji, day: dayGanji, hour: hourGanji };
    }

    _romanize(hangul) {
        const initial = {'ã„±':'g','ã„²':'kk','ã„´':'n','ã„·':'d','ã„¸':'tt','ã„¹':'r','ã…':'m','ã…‚':'b','ã…ƒ':'pp','ã……':'s','ã…†':'ss','ã…‡':'','ã…ˆ':'j','ã…‰':'jj','ã…Š':'ch','ã…‹':'k','ã…Œ':'t','ã…':'p','ã…':'h'}, medial = {'ã…':'a','ã…':'ae','ã…‘':'ya','ã…’':'yae','ã…“':'eo','ã…”':'e','ã…•':'yeo','ã…–':'ye','ã…—':'o','ã…˜':'wa','ã…™':'wae','ã…š':'oe','ã…›':'yo','ã…œ':'u','ã…':'wo','ã…':'we','ã…Ÿ':'wi','ã… ':'yu','ã…¡':'eu','ã…¢':'ui','ã…£':'i'}, final = {'':'','ã„±':'k','ã„²':'kk','ã„³':'ks','ã„´':'n','ã„µ':'nj','ã„¶':'nh','ã„·':'t','ã„¹':'l','ã„º':'lk','ã„»':'lm','ã„¼':'lb','ã„½':'ls','ã„¾':'lt','ã„¿':'lp','ã…€':'lh','ã…':'m','ã…‚':'p','ã…„':'ps','ã……':'t','ã…†':'ss','ã…‡':'ng','ã…ˆ':'t','ã…Š':'t','ã…‹':'k','ã…Œ':'t','ã…':'p','ã…':'h'}, ga = 44032; let r = '';
        for (let i = 0; i < hangul.length; i++) { const c = hangul.charCodeAt(i) - ga; if (c < 0 || c > 11171) continue; const iC=Math.floor(c/588), mC=Math.floor((c-(iC*588))/28), fC=c%28; r+=initial[Object.keys(initial)[iC]]; r+=medial[Object.keys(medial)[mC]]; r+=final[Object.keys(final)[fC]]; }
        return (r.charAt(0).toUpperCase() + r.slice(1));
    }
}

// ===================================================================================
// III. WEB APPLICATION LOGIC (UI & Event Handling)
// ===================================================================================

document.addEventListener('DOMContentLoaded', () => {
    const sajuNamer = new SajuNamer();
    const form = document.getElementById('sajuForm');
    
    const langContainer = document.getElementById('languageSelectorContainer');
    const langButton = document.getElementById('languageSelectorButton');
    const langOptions = document.getElementById('languageOptions');
    const selectedLangFlag = document.getElementById('selectedLangFlag');
    const selectedLangText = document.getElementById('selectedLangText');
    let currentLang = 'en';

    const langMap = { ko: { flag: 'ğŸ‡°ğŸ‡·', text: 'KR' }, en: { flag: 'ğŸ‡ºğŸ‡¸', text: 'EN' }, es: { flag: 'ğŸ‡ªğŸ‡¸', text: 'ES' } };

    langButton.addEventListener('click', () => {
        langOptions.classList.toggle('hidden');
    });

    document.querySelectorAll('.lang-option').forEach(option => {
        option.addEventListener('click', (e) => {
            e.preventDefault();
            const newLang = e.currentTarget.dataset.lang;
            if (newLang !== currentLang) {
                currentLang = newLang;
                setLanguage(currentLang);
                if (document.getElementById('resultsSection').classList.contains('section-visible')) {
                    document.getElementById('submitButton').click();
                }
            }
            langOptions.classList.add('hidden');
        });
    });

    document.addEventListener('click', (e) => {
        if (!langContainer.contains(e.target)) {
            langOptions.classList.add('hidden');
        }
    });
    
    function initializeUI() {
        const monthSelect = document.getElementById('month');
        const hourSelect = document.getElementById('hour');
        const minuteSelect = document.getElementById('minute');
        for (let i = 1; i <= 12; i++) { monthSelect.add(new Option(`${i}`.padStart(2, '0'), i)); }
        hourSelect.add(new Option("Unknown", -1));
        for (let i = 0; i <= 23; i++) { hourSelect.add(new Option(`${i}`.padStart(2, '0'), i)); }
        for (let i = 0; i <= 59; i++) { minuteSelect.add(new Option(`${i}`.padStart(2, '0'), i)); }
        setLanguage(currentLang);
    }
    
    function validateInputs() {
        let isValid = true;
        const yearInput = document.getElementById('year');
        const dayInput = document.getElementById('day');
        
        const yearError = document.getElementById('yearError');
        const dayError = document.getElementById('dayError');
        
        const year = parseInt(yearInput.value);
        const day = parseInt(dayInput.value);
        
        const trans = translations[currentLang];

        // Reset errors
        [yearInput, dayInput].forEach(input => input.classList.remove('border-red-500'));
        [yearError, dayError].forEach(err => err.textContent = '');

        // Validate Year
        if (isNaN(year) || year < 1940 || year > 2040) {
            yearInput.classList.add('border-red-500');
            yearError.textContent = trans.yearError;
            isValid = false;
        }

        // Validate Day
        if (isNaN(day) || day < 1 || day > 31) {
            dayInput.classList.add('border-red-500');
            dayError.textContent = trans.dayError;
            isValid = false;
        }
        
        return isValid;
    }

    form.addEventListener('submit', (e) => {
        e.preventDefault();
        
        if (!validateInputs()) {
            return;
        }

        const resultsSection = document.getElementById('resultsSection');
        resultsSection.classList.remove('section-visible'); resultsSection.classList.add('section-hidden');
        const year = parseInt(document.getElementById('year').value);
        const month = parseInt(document.getElementById('month').value);
        const day = parseInt(document.getElementById('day').value);
        const hour = parseInt(document.getElementById('hour').value);
        
        const loader = document.getElementById('loader');
        loader.style.display = 'flex';
        document.getElementById('submitButton').disabled = true;
        setTimeout(() => {
            const analysisResult = sajuNamer.analyze(year, month, day, hour);
            const names = sajuNamer.generateNames(analysisResult, 2);
            displayResults(analysisResult, names, {year, month, day}, hour === -1);
            loader.style.display = 'none';
            document.getElementById('submitButton').disabled = false;
            resultsSection.classList.remove('section-hidden');
            resultsSection.classList.add('section-visible');
            resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 1500);
    });

    function displayResults(analysis, names, birthDate, isTimeUnknown) {
        const trans = translations[currentLang] || translations['en'];
        document.getElementById('birthDateDisplay').textContent = `${birthDate.year}-${String(birthDate.month).padStart(2,'0')}-${String(birthDate.day).padStart(2,'0')}`;
        
        const { analysisSummary } = sajuNamer.generateExplanation(analysis, names[0], currentLang);
        document.getElementById('sajuAnalysisReport').innerHTML = analysisSummary;

        const chartContainer = document.getElementById('fiveElementsChart');
        chartContainer.innerHTML = '';
        const counts = analysis.elementCounts;
        const elements = ['wood', 'fire', 'earth', 'metal', 'water'];
        const maxCount = Math.max(...Object.values(counts), 1);
        elements.forEach(el => {
            const count = counts[el];
            const height = (count / maxCount) * 100;
            const barColor = {wood: 'bg-green-500', fire: 'bg-red-500', earth: 'bg-yellow-500', metal: 'bg-gray-400', water: 'bg-blue-500'};
            const chartEl = `<div class="flex flex-col items-center justify-end h-full text-center"><div class="w-full text-sm font-semibold mb-1">${count}</div><div class="${barColor[el]} w-full rounded-t-md" style="height: ${height}%; min-height: 2px;"></div><div class="mt-2 text-xs md:text-sm font-medium text-gray-600">${trans.elements[el]}</div></div>`;
            chartContainer.innerHTML += chartEl;
        });

        const namesContainer = document.getElementById('recommendedNames');
        namesContainer.innerHTML = '';
        names.forEach((name, index) => {
            const { nameExplanation } = sajuNamer.generateExplanation(analysis, name, currentLang);
            const card = `
                <div class="p-5 bg-blue-50 border border-blue-200 rounded-lg">
                    <h4 class="text-lg font-semibold text-blue-800 mb-3">${trans.recommendation} #${index + 1}: ${name.roman} (${name.hangul} / <span class="hanja">${name.hanja}</span>)</h4>
                    <div class="text-gray-600 leading-relaxed space-y-2">${nameExplanation}</div>
                </div>`;
            namesContainer.innerHTML += card;
        });
        
        const timeInfo = document.getElementById('timeInfo');
        timeInfo.style.display = isTimeUnknown ? 'block' : 'none';
    }
    
    function setLanguage(lang) {
        document.documentElement.lang = lang; // Set HTML lang attribute
        const t = translations[lang] || translations['en'];
        currentLang = lang;
        document.querySelectorAll('[data-lang]').forEach(el => {
            const key = el.dataset.lang;
            if (t[key]) el.textContent = t[key];
        });
        selectedLangFlag.textContent = langMap[lang].flag;
        selectedLangText.textContent = langMap[lang].text;
        document.getElementById('hour').options[0].text = t.unknownTime;
    }
    
    // --- Modal Logic ---
    const privacyModal = document.getElementById('privacyModal');
    const termsModal = document.getElementById('termsModal');
    
    document.getElementById('privacyPolicyLink').addEventListener('click', (e) => {
        e.preventDefault();
        privacyModal.style.display = 'flex';
    });
    
    document.getElementById('termsOfServiceLink').addEventListener('click', (e) => {
        e.preventDefault();
        termsModal.style.display = 'flex';
    });

    document.getElementById('closePrivacyModal').addEventListener('click', () => {
        privacyModal.style.display = 'none';
    });

    document.getElementById('closeTermsModal').addEventListener('click', () => {
        termsModal.style.display = 'none';
    });

    window.addEventListener('click', (e) => {
        if (e.target === privacyModal) privacyModal.style.display = 'none';
        if (e.target === termsModal) termsModal.style.display = 'none';
    });

    initializeUI();
});
</script>
</body>
</html>
